(function(){var SFlowApi,_base;SFlowApi=function(){function SFlowApi(){var sf;sf=SFLOW;this._sf=sf;this.addEventListener=sf.addEventListener;this.removeEventListener=sf.removeEventListener;this.dispatchEvent=sf.dispatchEvent;this._events=sf._events;this._eventCBs=sf._eventCBs;this.CREATED=true;this.INIT=false;this.READY=false;this.SCRIPTS=false;this.mod=sf.mod;this.r=sf.r;this._loopInterval=null;window.SFLOW=this;return}SFlowApi.prototype.loadComplete=function(){var sf;sf=SFLOW;$("#mainContainer").show();$("#sf_footer").show();$("#loadBox").remove();sf.SCRIPTS=true;sf.dispatchEvent({id:"SCRIPT:complete",oneShot:true});if(PAGE.ASYNC.length){loadItems(PAGE.ASYNC)}if(PAGE.HTML){sf.addEventListener("DOM:dynamic",function(event){return sf.populateDom(event.data)})}sf.dispatchEvent({id:"DOM:complete",oneShot:true});$(document).foundation();$(window).resize(function(){SFLOW.dispatchEvent({id:"DOM:resize",data:$("body")});return SFLOW.resize()});sf.dispatchEvent({id:"LOAD:complete",oneShot:true});sf.refresh();if(location.hash.length>1){sf.dispatchEvent({id:"PAGE:hashChange",data:location.hash})}sf.dispatchEvent({id:"API:ready",oneShot:true});sf._loopInterval=setInterval(sf._handleRenderLoop,100)};SFlowApi.prototype.resize=function(dom){dom=dom?$(dom):$("body");SFLOW.dispatchEvent({id:"DOM:resize",data:dom});return $(".sfml-aspect").each(function(index,element){var aspect,e;e=$(element);aspect=e.data("aspect");return e.height(Math.floor(e.width()/aspect))})};SFlowApi.prototype.refresh=function(dom){var lazyFunc;dom=dom?$(dom):$("body");dom.find(".columns").resize();lazyFunc=this._lazyReplacement;dom.find('img[data-src!=""]').each(function(index,element){return lazyFunc(element,"data-src","src")});dom.find('iframe[data-src!=""]').each(function(index,element){return lazyFunc(element,"data-src","src")});this._loadDiscus();SFLOW.resize(dom)};SFlowApi.prototype._lazyReplacement=function(element,sourceAttr,destAttr){var e,src;e=$(element);src=e.attr(sourceAttr);e.attr(sourceAttr,null);if(!src||src.length===0){return}if(src.substr(0,2)!=="//"&&src.substr(0,4)!=="http"){src=PAGE.CDN_URL+src}e.attr(destAttr,src)};SFlowApi.prototype._loadDiscus=function(){var e,id,local,prefix,script,sn,url;e=$("#disqus_thread");if(e.attr("data-rendered")){return}prefix="data-discus-";e.attr("data-rendered",1);sn=e.attr(prefix+"shortname");url=e.attr(prefix+"url");id=e.attr(prefix+"id");local=e.attr(prefix+"local");script='<script type="text/javascript">'+('\nvar disqus_shortname = "'+sn+'";')+('\nvar disqus_url = "'+url+'";')+('\nvar disqus_identifier = "'+id+'";')+("\nvar disqus_developer = "+local+";")+"\n(function() {"+"\nvar dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;"+("\ndsq.src = '//' + \""+sn+"\" + '.disqus.com/embed.js';")+"\n(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })();"+"\n</script>";e.append(script)};SFlowApi.prototype._handleRenderLoop=function(){return SFLOW.dispatchEvent("DOM:render")};return SFlowApi}();if((_base=SFLOW.r).SFlowApi==null){_base.SFlowApi=SFlowApi}window.SFLOW["class"]=SFLOW.r.SFlowApi}).call(this);